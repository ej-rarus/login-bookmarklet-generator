<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¡œê·¸ì¸ ë¶ë§ˆí¬ë › ìƒì„±ê¸°</title>

    <!-- Open Graph / SNS ê³µìœ  ë©”íƒ€ íƒœê·¸ -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="ë¡œê·¸ì¸ ë¶ë§ˆí¬ë › ìƒì„±ê¸°">
    <meta property="og:description" content="ê·€ì°®ì€ ë°˜ë³µ ë¡œê·¸ì¸, í´ë¦­ í•œ ë²ˆìœ¼ë¡œ ë! (ìˆœìˆ˜ JS Â· ì„œë²„ë¦¬ìŠ¤ Â· ë“œë˜ê·¸ ì•¤ ë“œë¡­)">
    <meta property="og:image" content="./og-image.png">
    <meta property="og:url" content="https://ej-rarus.github.io/login-bookmarklet-generator/">
    <meta name="description" content="í…ŒìŠ¤íŠ¸ ê³„ì •ìœ¼ë¡œ ë°˜ë³µ ë¡œê·¸ì¸í•˜ê¸° ê·€ì°®ì•„ì„œ ë§Œë“  ìë™ ë¡œê·¸ì¸ ë„êµ¬. HTML ì—…ë¡œë“œë§Œìœ¼ë¡œ ë¶ë§ˆí¬ë › ìë™ ìƒì„±!">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .main-wrapper {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            gap: 20px;
            align-items: flex-start;
        }

        .container {
            flex: 1;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        /* ì‚¬ì´ë“œë°” ìŠ¤íƒ€ì¼ */
        .sidebar {
            width: 280px;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            padding: 30px;
            position: sticky;
            top: 20px;
        }

        .sidebar h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 18px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
        }

        .sidebar-menu {
            list-style: none;
        }

        .sidebar-menu li {
            margin-bottom: 12px;
        }

        .sidebar-menu a {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 16px;
            background: #f8f9ff;
            border-radius: 8px;
            text-decoration: none;
            color: #333;
            font-weight: 500;
            transition: all 0.3s;
        }

        .sidebar-menu a:hover {
            background: #667eea;
            color: white;
            transform: translateX(5px);
        }

        .sidebar-menu a.active {
            background: #667eea;
            color: white;
        }

        .sidebar-icon {
            font-size: 20px;
        }

        /* ë°˜ì‘í˜• */
        @media (max-width: 1024px) {
            .main-wrapper {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                position: static;
            }

            .sidebar-menu {
                display: flex;
                flex-wrap: wrap;
                gap: 10px;
            }

            .sidebar-menu li {
                margin-bottom: 0;
                flex: 1;
                min-width: 200px;
            }
        }

        /* Footer ìŠ¤íƒ€ì¼ */
        .footer {
            text-align: center;
            padding: 20px;
            margin-top: 30px;
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
        }

        .footer a {
            color: white;
            text-decoration: none;
            font-weight: 600;
        }

        .footer a:hover {
            text-decoration: underline;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 16px;
        }

        .content {
            padding: 40px;
        }

        .upload-section {
            margin-bottom: 30px;
        }

        .upload-section h3 {
            color: #333;
            margin-bottom: 10px;
            font-size: 18px;
        }

        .upload-box {
            border: 3px dashed #667eea;
            border-radius: 12px;
            padding: 30px;
            text-align: center;
            background: #f8f9ff;
            cursor: pointer;
            transition: all 0.3s;
        }

        .upload-box:hover {
            border-color: #764ba2;
            background: #f0f2ff;
        }

        .upload-box.dragover {
            border-color: #764ba2;
            background: #e8ebff;
            transform: scale(1.02);
        }

        .upload-box input[type="file"] {
            display: none;
        }

        .upload-icon {
            font-size: 48px;
            margin-bottom: 10px;
        }

        .file-name {
            margin-top: 10px;
            color: #667eea;
            font-weight: 600;
        }

        .detected-info {
            margin-top: 15px;
            padding: 15px;
            background: #e8f5e9;
            border-radius: 8px;
            border-left: 4px solid #4caf50;
        }

        .detected-info h4 {
            color: #2e7d32;
            margin-bottom: 8px;
        }

        .detected-info code {
            background: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 13px;
            color: #d32f2f;
        }

        .generate-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .generate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }

        .generate-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .results {
            margin-top: 30px;
        }

        .bookmarklet-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .bookmarklet-table thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .bookmarklet-table th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
            font-size: 14px;
        }

        .bookmarklet-table td {
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
        }

        .bookmarklet-table tr:last-child td {
            border-bottom: none;
        }

        .bookmarklet-table tbody tr:hover {
            background: #f8f9ff;
        }

        .account-name {
            font-weight: 600;
            color: #333;
            font-size: 15px;
        }

        .account-id {
            font-size: 13px;
            color: #666;
            margin-top: 3px;
        }

        .code-box {
            background: #282c34;
            color: #abb2bf;
            padding: 8px;
            border-radius: 6px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 11px;
            overflow-x: auto;
            word-break: break-all;
            white-space: pre-wrap;
        }

        /* ë‚´ë³´ë‚´ê¸° ë²„íŠ¼ */
        .export-btn {
            background: #4caf50;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            font-size: 15px;
        }

        .export-btn:hover {
            background: #388e3c;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
        }

        .bookmarklet-link {
            display: inline-block;
            padding: 6px 12px;
            background: #f0f2ff;
            border: 2px dashed #667eea;
            border-radius: 6px;
            text-decoration: none;
            color: #667eea;
            font-weight: 600;
            transition: all 0.3s;
            cursor: move;
            font-size: 13px;
        }

        .bookmarklet-link:hover {
            background: #667eea;
            color: white;
            border-style: solid;
        }

        .action-buttons {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .small-copy-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s;
            font-size: 13px;
        }

        .small-copy-btn:hover {
            background: #764ba2;
        }

        .small-copy-btn.copied {
            background: #4caf50;
        }


        .instructions {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 25px;
            margin-top: 30px;
        }

        .instructions h4 {
            color: #333;
            margin-bottom: 20px;
            font-size: 18px;
            text-align: center;
        }

        .method-section {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9ff;
            border-radius: 8px;
            align-items: flex-start;
        }

        .method-number {
            flex-shrink: 0;
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 16px;
        }

        .method-content {
            flex: 1;
        }

        .method-content strong {
            color: #667eea;
            display: block;
            margin-bottom: 5px;
        }

        .method-content p {
            color: #666;
            line-height: 1.6;
            margin: 0;
        }

        .method-content code {
            background: #e8f5e9;
            color: #2e7d32;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 12px;
        }

        .tip-box {
            background: #e3f2fd;
            border-left: 4px solid #2196F3;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
        }

        .tip-box strong {
            color: #1565c0;
            display: block;
            margin-bottom: 8px;
        }

        .tip-box p {
            color: #424242;
            margin: 0;
            line-height: 1.6;
        }

        .tip-box code {
            background: white;
            color: #1976d2;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 12px;
        }

        .error-message {
            background: #ffebee;
            border-left: 4px solid #f44336;
            padding: 15px;
            border-radius: 8px;
            color: #c62828;
            margin-top: 15px;
        }

        .divider {
            text-align: center;
            margin: 20px 0;
            color: #999;
            font-weight: 600;
            position: relative;
        }

        .divider::before,
        .divider::after {
            content: '';
            position: absolute;
            top: 50%;
            width: 40%;
            height: 1px;
            background: #ddd;
        }

        .divider::before {
            left: 0;
        }

        .divider::after {
            right: 0;
        }

        .manual-input-section {
            background: #f8f9ff;
            border-radius: 12px;
            padding: 20px;
            margin-top: 15px;
        }

        .account-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
        }

        .account-table th {
            background: #667eea;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            font-size: 14px;
        }

        .account-table th:first-child {
            border-radius: 8px 0 0 0;
        }

        .account-table th:last-child {
            border-radius: 0 8px 0 0;
            width: 80px;
            text-align: center;
        }

        .account-table td {
            padding: 10px 12px;
            border-bottom: 1px solid #e0e0e0;
        }

        .account-table input[type="text"] {
            width: 100%;
            padding: 8px 12px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .account-table input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
        }

        .delete-row-btn {
            background: #f44336;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: background 0.3s;
        }

        .delete-row-btn:hover {
            background: #d32f2f;
        }

        .add-row-btn {
            background: #4caf50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s;
        }

        .add-row-btn:hover {
            background: #388e3c;
        }

        .account-count {
            margin-top: 10px;
            color: #667eea;
            font-weight: 600;
            font-size: 14px;
        }

        /* HTML ë¯¸ë¦¬ë³´ê¸° ìŠ¤íƒ€ì¼ */
        .preview-section {
            margin-top: 20px;
            border: 2px solid #667eea;
            border-radius: 12px;
            overflow: hidden;
            background: white;
        }

        .preview-header {
            background: #667eea;
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .preview-header h4 {
            margin: 0;
            font-size: 16px;
        }

        .manual-select-btn {
            background: white;
            color: #667eea;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s;
        }

        .manual-select-btn:hover {
            background: #f0f2ff;
            transform: translateY(-1px);
        }

        .preview-container {
            position: relative;
            height: 500px;
            background: #f5f5f5;
        }

        .preview-iframe {
            width: 100%;
            height: 100%;
            border: none;
            background: white;
        }

        /* ì„ íƒ ëª¨ë“œ ì˜¤ë²„ë ˆì´ */
        .selection-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.3);
            z-index: 1000;
            display: none;
            pointer-events: none; /* iframe í´ë¦­ í—ˆìš© */
        }

        .selection-overlay.active {
            display: block;
        }

        .selection-guide {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: white;
            padding: 20px 30px;
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.2);
            z-index: 1001;
            text-align: center;
            min-width: 400px;
            pointer-events: auto; /* ê°€ì´ë“œ ë°•ìŠ¤ëŠ” í´ë¦­ ê°€ëŠ¥ */
        }

        .selection-guide h3 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 18px;
        }

        .selection-guide p {
            color: #666;
            margin-bottom: 15px;
        }

        .selection-step {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .selection-cancel-btn {
            background: #f44336;
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .selection-cancel-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .selected-elements-display {
            margin-top: 15px;
            text-align: left;
            background: #f8f9ff;
            padding: 15px;
            border-radius: 8px;
        }

        .selected-elements-display div {
            margin: 5px 0;
            font-size: 13px;
        }

        .selected-elements-display code {
            background: white;
            padding: 2px 6px;
            border-radius: 4px;
            color: #d32f2f;
        }

        /* í•˜ì´ë¼ì´íŠ¸ ìŠ¤íƒ€ì¼ */
        .element-highlight {
            outline: 3px solid #4caf50 !important;
            outline-offset: 2px;
            background: rgba(76, 175, 80, 0.1) !important;
            cursor: pointer !important;
        }

        .element-selected {
            outline: 3px solid #2196F3 !important;
            outline-offset: 2px;
            background: rgba(33, 150, 243, 0.2) !important;
        }
    </style>
</head>
<body>
    <div class="main-wrapper">
        <div class="container">
            <div class="header">
                <h1>ğŸ” ë¡œê·¸ì¸ ë¶ë§ˆí¬ë › ìƒì„±ê¸°</h1>
                <p>HTML íŒŒì¼ê³¼ ê³„ì • ëª©ë¡ì„ ì—…ë¡œë“œí•˜ë©´ ìë™ ë¡œê·¸ì¸ ë¶ë§ˆí¬ë ›ì„ ìƒì„±í•©ë‹ˆë‹¤</p>
            </div>

        <div class="content">
            <!-- HTML íŒŒì¼ ì—…ë¡œë“œ -->
            <div class="upload-section">
                <h3>1ï¸âƒ£ ë¡œê·¸ì¸ í˜ì´ì§€ HTML íŒŒì¼</h3>
                <div class="upload-box" id="htmlUploadBox">
                    <input type="file" id="htmlFileInput" accept=".html,.htm">
                    <div class="upload-icon">ğŸ“„</div>
                    <div>í´ë¦­í•˜ê±°ë‚˜ íŒŒì¼ì„ ë“œë˜ê·¸í•˜ì„¸ìš”</div>
                    <div class="file-name" id="htmlFileName"></div>
                </div>
                <div id="detectedInfo"></div>

                <!-- HTML ë¯¸ë¦¬ë³´ê¸° ì„¹ì…˜ -->
                <div class="preview-section" id="previewSection" style="display: none;">
                    <div class="preview-header">
                        <h4>ğŸ“± ë¡œê·¸ì¸ í˜ì´ì§€ ë¯¸ë¦¬ë³´ê¸°</h4>
                        <button class="manual-select-btn" onclick="startManualSelection()">
                            ğŸ¯ ì§ì ‘ ì„ íƒí•˜ê¸°
                        </button>
                    </div>
                    <div class="preview-container">
                        <iframe id="previewIframe" class="preview-iframe" sandbox="allow-same-origin allow-scripts"></iframe>

                        <!-- ì„ íƒ ëª¨ë“œ ì˜¤ë²„ë ˆì´ -->
                        <div class="selection-overlay" id="selectionOverlay">
                            <div class="selection-guide">
                                <div class="selection-step" id="selectionStep">1ë‹¨ê³„: ID ì…ë ¥ í•„ë“œ</div>
                                <h3 id="selectionTitle">ID ì…ë ¥ í•„ë“œë¥¼ í´ë¦­í•˜ì„¸ìš”</h3>
                                <p id="selectionDesc">ë¡œê·¸ì¸ í˜ì´ì§€ì—ì„œ ì•„ì´ë””ë¥¼ ì…ë ¥í•˜ëŠ” í•„ë“œë¥¼ í´ë¦­í•´ì£¼ì„¸ìš”</p>

                                <div class="selected-elements-display" id="selectedDisplay" style="display: none;">
                                    <div id="selectedIdDisplay"></div>
                                    <div id="selectedPwDisplay"></div>
                                    <div id="selectedBtnDisplay"></div>
                                </div>

                                <div style="margin-top: 15px; display: flex; gap: 10px; justify-content: center;">
                                    <button class="selection-cancel-btn" onclick="resetCurrentStep()" style="background: #ff9800;">
                                        â†¶ ì´ì „ ë‹¨ê³„
                                    </button>
                                    <button class="selection-cancel-btn" onclick="cancelSelection()">
                                        âœ• ì·¨ì†Œ
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ -->
            <div class="upload-section">
                <h3>2ï¸âƒ£ í…ŒìŠ¤íŠ¸ ê³„ì • ëª©ë¡</h3>
                <div class="upload-box" id="excelUploadBox">
                    <input type="file" id="excelFileInput" accept=".xlsx,.xls">
                    <div class="upload-icon">ğŸ“Š</div>
                    <div>IDì™€ Password ì»¬ëŸ¼ì´ í¬í•¨ëœ ì—‘ì…€ íŒŒì¼</div>
                    <div class="file-name" id="excelFileName"></div>
                </div>

                <div class="divider">ë˜ëŠ”</div>

                <div class="manual-input-section">
                    <h4 style="margin-bottom: 15px; color: #333;">ì§ì ‘ ì…ë ¥</h4>
                    <table class="account-table">
                        <thead>
                            <tr>
                                <th>ê³„ì • ì´ë¦„</th>
                                <th>ì•„ì´ë””</th>
                                <th>ë¹„ë°€ë²ˆí˜¸</th>
                                <th>ì‚­ì œ</th>
                            </tr>
                        </thead>
                        <tbody id="manualAccountTable">
                            <tr>
                                <td><input type="text" placeholder="ì˜ˆ: í™ê¸¸ë™ ê³„ì •" class="account-name"></td>
                                <td><input type="text" placeholder="testuser1" class="account-id"></td>
                                <td><input type="text" placeholder="password123" class="account-pw"></td>
                                <td style="text-align: center;">
                                    <button class="delete-row-btn" onclick="deleteRow(this)">ì‚­ì œ</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <button class="add-row-btn" onclick="addRow()">+ ê³„ì • ì¶”ê°€</button>
                    <div class="account-count" id="manualAccountCount">ìˆ˜ë™ ì…ë ¥: 0ê°œ ê³„ì •</div>
                </div>
            </div>

            <!-- ìƒì„± ë²„íŠ¼ -->
            <button class="generate-btn" id="generateBtn" disabled>ë¶ë§ˆí¬ë › ìƒì„±í•˜ê¸°</button>

            <!-- ê²°ê³¼ ì˜ì—­ -->
            <div class="results" id="results"></div>

            <!-- ë‚´ë³´ë‚´ê¸° ë²„íŠ¼ (ê²°ê³¼ ìƒì„± í›„ í‘œì‹œ) -->
            <div id="exportSection" style="display: none; margin-top: 20px; text-align: center;">
                <button class="export-btn" onclick="exportBookmarks()">
                    ğŸ“¥ ëª¨ë“  ë¶ë§ˆí¬ HTMLë¡œ ë‚´ë³´ë‚´ê¸°
                </button>
                <div style="margin-top: 10px; color: #666; font-size: 13px;">
                    ë¸Œë¼ìš°ì € ì„¤ì • â†’ ë¶ë§ˆí¬ â†’ ë¶ë§ˆí¬ ê°€ì ¸ì˜¤ê¸°ë¡œ ì¼ê´„ ë“±ë¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
                </div>
            </div>

            <!-- ì‚¬ìš© ë°©ë²• -->
            <div class="instructions">
                <h4>ğŸ“Œ ë¶ë§ˆí¬ ë“±ë¡ 3ê°€ì§€ ë°©ë²•</h4>

                <div class="method-section">
                    <div class="method-number">1</div>
                    <div class="method-content">
                        <strong>ğŸ–±ï¸ ë“œë˜ê·¸ ì•¤ ë“œë¡­ (ê°€ì¥ ì‰¬ì›€!)</strong>
                        <p>ìƒì„±ëœ í‘œì—ì„œ <code>ğŸ“Œ ê³„ì • ì´ë¦„</code> ë§í¬ë¥¼ ë¸Œë¼ìš°ì € ë¶ë§ˆí¬ë°”ë¡œ ë“œë˜ê·¸</p>
                    </div>
                </div>

                <div class="method-section">
                    <div class="method-number">2</div>
                    <div class="method-content">
                        <strong>ğŸ“¥ HTML íŒŒì¼ë¡œ ì¼ê´„ ë“±ë¡</strong>
                        <p><code>ğŸ“¥ ëª¨ë“  ë¶ë§ˆí¬ HTMLë¡œ ë‚´ë³´ë‚´ê¸°</code> ë²„íŠ¼ í´ë¦­ â†’ ë¸Œë¼ìš°ì € ì„¤ì • â†’ ë¶ë§ˆí¬ ê°€ì ¸ì˜¤ê¸° â†’ ë‹¤ìš´ë¡œë“œëœ íŒŒì¼ ì„ íƒ</p>
                    </div>
                </div>

                <div class="method-section">
                    <div class="method-number">3</div>
                    <div class="method-content">
                        <strong>ğŸ“‹ ì½”ë“œ ë³µì‚¬í•˜ì—¬ ìˆ˜ë™ ë“±ë¡</strong>
                        <p><code>ğŸ“‹ ì½”ë“œ ë³µì‚¬</code> ë²„íŠ¼ â†’ ë¶ë§ˆí¬ë°” ìš°í´ë¦­ â†’ ìƒˆ ë¶ë§ˆí¬ ì¶”ê°€ â†’ URLì— ë¶™ì—¬ë„£ê¸°</p>
                    </div>
                </div>

                <div class="tip-box">
                    <strong>ğŸ’¡ HTML íŒŒì¼ ì¤€ë¹„ Tip</strong>
                    <p>ë¡œê·¸ì¸ í˜ì´ì§€ì—ì„œ <code>Ctrl+S</code> (Mac: <code>Cmd+S</code>) ëˆ„ë¥´ê³  ì €ì¥í•˜ë©´ ë!</p>
                </div>
            </div>
        </div>
        </div>

        <!-- ì‚¬ì´ë“œë°” -->
        <aside class="sidebar">
            <h3>ğŸ“š ë©”ë‰´</h3>
            <ul class="sidebar-menu">
                <li>
                    <a href="index.html" class="active">
                        <span class="sidebar-icon">ğŸ </span>
                        <span>ë¶ë§ˆí¬ë › ìƒì„±</span>
                    </a>
                </li>
                <li>
                    <a href="tutorial.html">
                        <span class="sidebar-icon">ğŸ“–</span>
                        <span>ì‚¬ìš© íŠœí† ë¦¬ì–¼</span>
                    </a>
                </li>
            </ul>

            <div style="margin-top: 30px; padding: 15px; background: #f8f9ff; border-radius: 8px; font-size: 13px; color: #666;">
                <strong style="color: #667eea;">ğŸ’¡ Quick Tips</strong><br>
                â€¢ ë¶ë§ˆí¬ ë“±ë¡: ë“œë˜ê·¸ê°€ ì œì¼ ì‰¬ì›Œìš”!<br>
                â€¢ ìë™ ê°ì§€ ì‹¤íŒ¨ â†’ ğŸ¯ ì§ì ‘ ì„ íƒ<br>
                â€¢ HTML íŒŒì¼ë¡œ ì¼ê´„ ë‚´ë³´ë‚´ê¸° ê°€ëŠ¥
            </div>
        </aside>
    </div>

    <!-- Footer -->
    <div class="footer">
        Made with â¤ï¸ by <a href="https://leeeunjae.com" target="_blank"><strong>EJ Lee</strong></a> | Â© 2025 All rights reserved
    </div>

    <script>
        let parsedHTML = null;
        let detectedSelectors = null;
        let accountList = [];
        let manualAccounts = [];
        let htmlContent = '';
        let currentSelectionStep = 0;
        let manualSelectors = {
            idSelector: null,
            passwordSelector: null,
            buttonSelector: null
        };
        let lastHighlightedElement = null;

        // HTML íŒŒì¼ ì—…ë¡œë“œ ì²˜ë¦¬
        const htmlUploadBox = document.getElementById('htmlUploadBox');
        const htmlFileInput = document.getElementById('htmlFileInput');
        const htmlFileName = document.getElementById('htmlFileName');
        const detectedInfo = document.getElementById('detectedInfo');

        htmlUploadBox.addEventListener('click', () => htmlFileInput.click());

        htmlUploadBox.addEventListener('dragover', (e) => {
            e.preventDefault();
            htmlUploadBox.classList.add('dragover');
        });

        htmlUploadBox.addEventListener('dragleave', () => {
            htmlUploadBox.classList.remove('dragover');
        });

        htmlUploadBox.addEventListener('drop', (e) => {
            e.preventDefault();
            htmlUploadBox.classList.remove('dragover');
            if (e.dataTransfer.files.length) {
                handleHTMLFile(e.dataTransfer.files[0]);
            }
        });

        htmlFileInput.addEventListener('change', (e) => {
            if (e.target.files.length) {
                handleHTMLFile(e.target.files[0]);
            }
        });

        function handleHTMLFile(file) {
            const reader = new FileReader();
            reader.onload = (e) => {
                htmlContent = e.target.result;
                parseHTML(htmlContent);
                htmlFileName.textContent = `âœ“ ${file.name}`;

                // iframeì— HTML ë Œë”ë§
                const previewIframe = document.getElementById('previewIframe');

                // iframe ë¡œë“œ ì™„ë£Œ í›„ ìŠ¤íƒ€ì¼ ì£¼ì…
                previewIframe.onload = function() {
                    injectStylesIntoIframe(previewIframe);
                };

                previewIframe.srcdoc = htmlContent;
                document.getElementById('previewSection').style.display = 'block';

                checkGenerateButton();
            };
            reader.readAsText(file);
        }

        // iframeì— ìŠ¤íƒ€ì¼ ì£¼ì…
        function injectStylesIntoIframe(iframe) {
            try {
                const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;

                // í•˜ì´ë¼ì´íŠ¸ ìŠ¤íƒ€ì¼ ì¶”ê°€
                const style = iframeDoc.createElement('style');
                style.textContent = `
                    .element-highlight {
                        outline: 3px solid #4caf50 !important;
                        outline-offset: 2px;
                        background: rgba(76, 175, 80, 0.1) !important;
                        cursor: pointer !important;
                        transition: all 0.2s ease !important;
                    }
                    .element-selected {
                        outline: 3px solid #2196F3 !important;
                        outline-offset: 2px;
                        background: rgba(33, 150, 243, 0.2) !important;
                    }
                    .selectable-element {
                        cursor: pointer !important;
                    }
                `;
                iframeDoc.head.appendChild(style);
            } catch (error) {
                console.error('ìŠ¤íƒ€ì¼ ì£¼ì… ì˜¤ë¥˜:', error);
            }
        }

        function parseHTML(htmlContent) {
            const parser = new DOMParser();
            const doc = parser.parseFromString(htmlContent, 'text/html');

            // ë¡œê·¸ì¸ í¼ ìš”ì†Œ ì°¾ê¸°
            const selectors = detectLoginFormElements(doc);

            if (selectors.error) {
                detectedInfo.innerHTML = `
                    <div class="error-message">
                        <strong>âš ï¸ ìë™ ê°ì§€ ì‹¤íŒ¨:</strong> ${selectors.error}<br>
                        <strong>ğŸ’¡ í•´ê²° ë°©ë²•:</strong> ì•„ë˜ ë¯¸ë¦¬ë³´ê¸°ì—ì„œ <strong>"ğŸ¯ ì§ì ‘ ì„ íƒí•˜ê¸°"</strong> ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ìš”ì†Œë¥¼ ìˆ˜ë™ìœ¼ë¡œ ì„ íƒí•´ì£¼ì„¸ìš”.
                    </div>
                `;
                parsedHTML = null;
                detectedSelectors = null;
            } else {
                parsedHTML = doc;
                detectedSelectors = selectors;

                detectedInfo.innerHTML = `
                    <div class="detected-info">
                        <h4>âœ… ê°ì§€ëœ ìš”ì†Œ:</h4>
                        <div>ID í•„ë“œ: <code>${selectors.idSelector}</code></div>
                        <div>ë¹„ë°€ë²ˆí˜¸ í•„ë“œ: <code>${selectors.passwordSelector}</code></div>
                        <div>ë¡œê·¸ì¸ ë²„íŠ¼: <code>${selectors.buttonSelector}</code></div>
                    </div>
                `;
            }
        }

        function detectLoginFormElements(doc) {
            // ë¹„ë°€ë²ˆí˜¸ í•„ë“œ ì°¾ê¸° (ê°€ì¥ í™•ì‹¤í•œ ìš”ì†Œ)
            const passwordInput = doc.querySelector('input[type="password"]');
            if (!passwordInput) {
                return { error: 'ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ í•„ë“œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.' };
            }

            // ID/Email í•„ë“œ ì°¾ê¸° - name ì†ì„± ìš°ì„  ê²€ìƒ‰
            let idInput = null;
            const candidates = [
                // name ì†ì„±ìœ¼ë¡œ ì°¾ê¸°
                'input[name="username"]',
                'input[name="user"]',
                'input[name="userid"]',
                'input[name="user_id"]',
                'input[name="email"]',
                'input[name="login"]',
                'input[name*="user" i]',
                'input[name*="id" i]',
                // typeìœ¼ë¡œ ì°¾ê¸°
                'input[type="email"]',
                // id ì†ì„±ìœ¼ë¡œ ì°¾ê¸°
                'input[id*="user" i]',
                'input[id*="id" i]',
                'input[id*="email" i]',
                // ì¼ë°˜ í…ìŠ¤íŠ¸ í•„ë“œ (ë§ˆì§€ë§‰ ìˆ˜ë‹¨)
                'input[type="text"]',
                'input:not([type])'
            ];

            for (const selector of candidates) {
                try {
                    idInput = doc.querySelector(selector);
                    if (idInput && idInput !== passwordInput && idInput.type !== 'password') {
                        break;
                    }
                } catch (e) {
                    continue;
                }
            }

            if (!idInput) {
                return { error: 'ID ì…ë ¥ í•„ë“œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.' };
            }

            // ë¡œê·¸ì¸ ë²„íŠ¼ ì°¾ê¸°
            let submitButton = null;
            const buttonCandidates = [
                'button[type="submit"]',
                'input[type="submit"]',
                'form button',
                'button',
                'form input[type="button"]'
            ];

            for (const selector of buttonCandidates) {
                try {
                    submitButton = doc.querySelector(selector);
                    if (submitButton) break;
                } catch (e) {
                    continue;
                }
            }

            // ë²„íŠ¼ì„ ëª» ì°¾ìœ¼ë©´ form submitìœ¼ë¡œ ëŒ€ì²´
            if (!submitButton) {
                const form = passwordInput.closest('form');
                if (form) {
                    submitButton = { isForm: true };
                }
            }

            if (!submitButton) {
                return { error: 'ë¡œê·¸ì¸ ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.' };
            }

            // Selector ìƒì„± - name ì†ì„± ìš°ì„  ì‚¬ìš©
            const getUniqueSelector = (element) => {
                if (element.name) return `input[name="${element.name}"]`;
                if (element.id) return `#${element.id}`;
                if (element.type) return `input[type="${element.type}"]`;

                // placeholderë¡œ ì‹ë³„ ì‹œë„
                if (element.placeholder) {
                    return `input[placeholder="${element.placeholder}"]`;
                }

                return element.tagName.toLowerCase();
            };

            return {
                idSelector: getUniqueSelector(idInput),
                passwordSelector: getUniqueSelector(passwordInput),
                buttonSelector: submitButton.isForm
                    ? 'form'
                    : 'button[type="submit"]',
                isFormSubmit: submitButton.isForm || false
            };
        }

        // ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ ì²˜ë¦¬
        const excelUploadBox = document.getElementById('excelUploadBox');
        const excelFileInput = document.getElementById('excelFileInput');
        const excelFileName = document.getElementById('excelFileName');

        excelUploadBox.addEventListener('click', () => excelFileInput.click());

        excelUploadBox.addEventListener('dragover', (e) => {
            e.preventDefault();
            excelUploadBox.classList.add('dragover');
        });

        excelUploadBox.addEventListener('dragleave', () => {
            excelUploadBox.classList.remove('dragover');
        });

        excelUploadBox.addEventListener('drop', (e) => {
            e.preventDefault();
            excelUploadBox.classList.remove('dragover');
            if (e.dataTransfer.files.length) {
                handleExcelFile(e.dataTransfer.files[0]);
            }
        });

        excelFileInput.addEventListener('change', (e) => {
            if (e.target.files.length) {
                handleExcelFile(e.target.files[0]);
            }
        });

        function handleExcelFile(file) {
            const reader = new FileReader();
            reader.onload = (e) => {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, { type: 'array' });
                const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                const jsonData = XLSX.utils.sheet_to_json(firstSheet);

                // ID, Password ì»¬ëŸ¼ ì°¾ê¸° (ëŒ€ì†Œë¬¸ì ë¬´ì‹œ)
                accountList = jsonData.map(row => {
                    const idKey = Object.keys(row).find(key =>
                        key.toLowerCase().includes('id') ||
                        key.toLowerCase().includes('user') ||
                        key.toLowerCase().includes('email')
                    );
                    const pwKey = Object.keys(row).find(key =>
                        key.toLowerCase().includes('pass') ||
                        key.toLowerCase().includes('pw')
                    );

                    return {
                        id: row[idKey] || '',
                        password: row[pwKey] || '',
                        name: row.name || row.Name || row['ì´ë¦„'] || `ê³„ì • ${jsonData.indexOf(row) + 1}`
                    };
                }).filter(acc => acc.id && acc.password);

                excelFileName.textContent = `âœ“ ${file.name} (${accountList.length}ê°œ ê³„ì •)`;
                checkGenerateButton();
            };
            reader.readAsArrayBuffer(file);
        }

        function checkGenerateButton() {
            const manualAccounts = getManualAccounts();
            const totalAccounts = accountList.length + manualAccounts.length;

            const generateBtn = document.getElementById('generateBtn');
            if (detectedSelectors && totalAccounts > 0) {
                generateBtn.disabled = false;
            } else {
                generateBtn.disabled = true;
            }
        }

        // ìˆ˜ë™ ì…ë ¥ ê³„ì • ì •ë³´ ê°€ì ¸ì˜¤ê¸°
        function getManualAccounts() {
            const table = document.getElementById('manualAccountTable');
            const rows = table.querySelectorAll('tr');
            const accounts = [];

            rows.forEach(row => {
                const nameInput = row.querySelector('.account-name');
                const idInput = row.querySelector('.account-id');
                const pwInput = row.querySelector('.account-pw');

                if (idInput && pwInput && idInput.value.trim() && pwInput.value.trim()) {
                    accounts.push({
                        name: nameInput.value.trim() || `ê³„ì • ${accounts.length + 1}`,
                        id: idInput.value.trim(),
                        password: pwInput.value.trim()
                    });
                }
            });

            return accounts;
        }

        // ìˆ˜ë™ ì…ë ¥ ê³„ì • ìˆ˜ ì—…ë°ì´íŠ¸
        function updateManualAccountCount() {
            const accounts = getManualAccounts();
            document.getElementById('manualAccountCount').textContent =
                `ìˆ˜ë™ ì…ë ¥: ${accounts.length}ê°œ ê³„ì •`;
            checkGenerateButton();
        }

        // í–‰ ì¶”ê°€
        function addRow() {
            const table = document.getElementById('manualAccountTable');
            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td><input type="text" placeholder="ì˜ˆ: í™ê¸¸ë™ ê³„ì •" class="account-name" oninput="updateManualAccountCount()"></td>
                <td><input type="text" placeholder="testuser1" class="account-id" oninput="updateManualAccountCount()"></td>
                <td><input type="text" placeholder="password123" class="account-pw" oninput="updateManualAccountCount()"></td>
                <td style="text-align: center;">
                    <button class="delete-row-btn" onclick="deleteRow(this)">ì‚­ì œ</button>
                </td>
            `;
            table.appendChild(newRow);
            updateManualAccountCount();
        }

        // í–‰ ì‚­ì œ
        function deleteRow(button) {
            const row = button.closest('tr');
            const table = document.getElementById('manualAccountTable');

            // ìµœì†Œ 1ê°œ í–‰ì€ ìœ ì§€
            if (table.querySelectorAll('tr').length > 1) {
                row.remove();
            } else {
                // ë§ˆì§€ë§‰ í–‰ì€ ì‚­ì œí•˜ì§€ ì•Šê³  ë‚´ìš©ë§Œ ë¹„ì›€
                row.querySelectorAll('input').forEach(input => input.value = '');
            }

            updateManualAccountCount();
        }

        // ì´ˆê¸° í–‰ì—ë„ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
        document.addEventListener('DOMContentLoaded', () => {
            const initialInputs = document.querySelectorAll('#manualAccountTable input');
            initialInputs.forEach(input => {
                input.addEventListener('input', updateManualAccountCount);
            });
        });

        // ë¶ë§ˆí¬ë › ìƒì„±
        document.getElementById('generateBtn').addEventListener('click', generateBookmarklets);

        function generateBookmarklets() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = `
                <h3 style="margin-bottom: 15px; color: #333;">ìƒì„±ëœ ë¶ë§ˆí¬ë ›</h3>
                <div style="background: #e3f2fd; border-left: 4px solid #2196F3; padding: 12px; border-radius: 6px; margin-bottom: 20px; font-size: 13px; color: #1565c0;">
                    <strong>ğŸ–±ï¸ ì‚¬ìš©ë²•:</strong> ë¶ë§ˆí¬ ë§í¬(ğŸ“Œ)ë¥¼ ë¸Œë¼ìš°ì € ë¶ë§ˆí¬ë°”ë¡œ ë“œë˜ê·¸í•˜ê±°ë‚˜, ì½”ë“œ ë³µì‚¬ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”
                </div>
                <table class="bookmarklet-table">
                    <thead>
                        <tr>
                            <th style="width: 25%;">ê³„ì • ì •ë³´</th>
                            <th style="width: 35%;">ë¶ë§ˆí¬ ë“œë˜ê·¸</th>
                            <th style="width: 40%;">ë™ì‘</th>
                        </tr>
                    </thead>
                    <tbody id="bookmarkletTableBody">
                    </tbody>
                </table>
            `;

            // ì—‘ì…€ê³¼ ìˆ˜ë™ ì…ë ¥ ê³„ì • ë³‘í•©
            const manualAccounts = getManualAccounts();
            const allAccounts = [...accountList, ...manualAccounts];

            const tableBody = document.getElementById('bookmarkletTableBody');

            allAccounts.forEach((account, index) => {
                const bookmarkletCode = createBookmarkletCode(account);

                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>
                        <div class="account-name">${escapeHtml(account.name)}</div>
                        <div class="account-id">ID: ${escapeHtml(account.id)}</div>
                    </td>
                    <td>
                        <a href="${bookmarkletCode}" class="bookmarklet-link" draggable="true">
                            ğŸ“Œ ${escapeHtml(account.name)}
                        </a>
                    </td>
                    <td>
                        <div class="action-buttons">
                            <button class="small-copy-btn" onclick="copyBookmarkletCode(${index}, '${escapeHtml(account.name)}', this)">
                                ğŸ“‹ ì½”ë“œ ë³µì‚¬
                            </button>
                        </div>
                        <div class="code-box" id="code-${index}" style="display: none; margin-top: 10px; font-size: 11px; padding: 8px;">${escapeHtml(bookmarkletCode)}</div>
                    </td>
                `;

                tableBody.appendChild(row);
            });

            // ë‚´ë³´ë‚´ê¸° ë²„íŠ¼ í‘œì‹œ
            document.getElementById('exportSection').style.display = 'block';
        }

        function createBookmarkletCode(account) {
            const { idSelector, passwordSelector, buttonSelector, isFormSubmit } = detectedSelectors;

            const code = `
(function() {
    const idInput = document.querySelector('${idSelector}');
    const pwInput = document.querySelector('${passwordSelector}');

    if (idInput) idInput.value = '${account.id.replace(/'/g, "\\'")}';
    if (pwInput) pwInput.value = '${account.password.replace(/'/g, "\\'")}';

    ${isFormSubmit
        ? `const form = pwInput?.closest('form'); if (form) form.submit();`
        : `const btn = document.querySelector('${buttonSelector}'); if (btn) btn.click();`
    }
})();
            `.trim();

            return `javascript:${encodeURIComponent(code)}`;
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function copyCode(index, accountName) {
            const codeElement = document.getElementById(`code-${index}`);
            const code = codeElement.textContent;

            navigator.clipboard.writeText(code).then(() => {
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = 'âœ… ë³µì‚¬ë¨!';
                btn.classList.add('copied');

                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.classList.remove('copied');
                }, 2000);
            });
        }

        // ëª©ë¡í˜• ë¶ë§ˆí¬ë › ì½”ë“œ ë³µì‚¬
        function copyBookmarkletCode(index, accountName, btnElement) {
            const codeElement = document.getElementById(`code-${index}`);
            const code = codeElement.textContent;

            navigator.clipboard.writeText(code).then(() => {
                const originalText = btnElement.textContent;
                btnElement.textContent = 'âœ… ë³µì‚¬ë¨!';
                btnElement.classList.add('copied');

                setTimeout(() => {
                    btnElement.textContent = originalText;
                    btnElement.classList.remove('copied');
                }, 2000);
            });
        }

        // ë¶ë§ˆí¬ HTML íŒŒì¼ë¡œ ë‚´ë³´ë‚´ê¸°
        function exportBookmarks() {
            const manualAccounts = getManualAccounts();
            const allAccounts = [...accountList, ...manualAccounts];

            if (allAccounts.length === 0) {
                alert('âš ï¸ ìƒì„±ëœ ë¶ë§ˆí¬ë ›ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            // ë¶ë§ˆí¬ HTML í˜•ì‹ ìƒì„±
            const timestamp = Math.floor(Date.now() / 1000);
            let bookmarksHTML = `<!DOCTYPE NETSCAPE-Bookmark-file-1>
<!-- This is an automatically generated file.
     It will be read and overwritten.
     DO NOT EDIT! -->
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
<TITLE>Bookmarks</TITLE>
<H1>Bookmarks</H1>
<DL><p>
    <DT><H3 ADD_DATE="${timestamp}" LAST_MODIFIED="${timestamp}">ë¡œê·¸ì¸ ë¶ë§ˆí¬ë ›</H3>
    <DL><p>
`;

            // ê° ê³„ì •ë³„ ë¶ë§ˆí¬ ì¶”ê°€
            allAccounts.forEach(account => {
                const bookmarkletCode = createBookmarkletCode(account);
                const escapedName = escapeHtml(account.name);
                bookmarksHTML += `        <DT><A HREF="${bookmarkletCode}" ADD_DATE="${timestamp}">${escapedName}</A>\n`;
            });

            bookmarksHTML += `    </DL><p>
</DL><p>
`;

            // íŒŒì¼ ë‹¤ìš´ë¡œë“œ
            const blob = new Blob([bookmarksHTML], { type: 'text/html;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'login-bookmarklets.html';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);

            // ì„±ê³µ ë©”ì‹œì§€
            alert(`âœ… ë¶ë§ˆí¬ íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!\n\nì‚¬ìš© ë°©ë²•:\n1. ë¸Œë¼ìš°ì € ì„¤ì • â†’ ë¶ë§ˆí¬ â†’ ë¶ë§ˆí¬ ê°€ì ¸ì˜¤ê¸°\n2. ë‹¤ìš´ë¡œë“œëœ íŒŒì¼ ì„ íƒ\n3. ì™„ë£Œ!`);
        }

        // ========== ìˆ˜ë™ ì„ íƒ ëª¨ë“œ ê¸°ëŠ¥ ==========

        function startManualSelection() {
            currentSelectionStep = 0;
            manualSelectors = {
                idSelector: null,
                passwordSelector: null,
                buttonSelector: null
            };

            // ì˜¤ë²„ë ˆì´ í‘œì‹œ
            const overlay = document.getElementById('selectionOverlay');
            overlay.classList.add('active');

            // ì²« ë‹¨ê³„ ì•ˆë‚´
            updateSelectionGuide();

            // iframe ë‚´ë¶€ ìš”ì†Œì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            const iframe = document.getElementById('previewIframe');

            // iframe ì™„ì „íˆ ë¡œë“œë˜ì—ˆëŠ”ì§€ í™•ì¸
            if (iframe.contentDocument && iframe.contentDocument.readyState === 'complete') {
                setupIframeListeners(iframe);
            } else {
                iframe.onload = function() {
                    injectStylesIntoIframe(iframe);
                    setupIframeListeners(iframe);
                };
            }
        }

        function resetCurrentStep() {
            if (currentSelectionStep > 0) {
                currentSelectionStep--;

                // í•´ë‹¹ ë‹¨ê³„ì˜ ì„ íƒ ì´ˆê¸°í™”
                if (currentSelectionStep === 0) {
                    manualSelectors.idSelector = null;
                } else if (currentSelectionStep === 1) {
                    manualSelectors.passwordSelector = null;
                } else if (currentSelectionStep === 2) {
                    manualSelectors.buttonSelector = null;
                }

                // iframe ë‚´ ì„ íƒëœ ìš”ì†Œ ìŠ¤íƒ€ì¼ ì œê±°
                try {
                    const iframe = document.getElementById('previewIframe');
                    const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                    const selected = iframeDoc.querySelectorAll('.element-selected');
                    selected.forEach(el => {
                        el.classList.remove('element-selected');
                    });
                } catch (error) {
                    console.error('ìš”ì†Œ ì œê±° ì˜¤ë¥˜:', error);
                }

                // ê°€ì´ë“œ ì—…ë°ì´íŠ¸
                updateSelectionGuide();
            }
        }

        function updateSelectionGuide() {
            const steps = [
                {
                    title: 'ID ì…ë ¥ í•„ë“œë¥¼ í´ë¦­í•˜ì„¸ìš”',
                    desc: 'ë¡œê·¸ì¸ í˜ì´ì§€ì—ì„œ ì•„ì´ë””ë¥¼ ì…ë ¥í•˜ëŠ” í•„ë“œë¥¼ í´ë¦­í•´ì£¼ì„¸ìš”',
                    step: '1ë‹¨ê³„: ID ì…ë ¥ í•„ë“œ'
                },
                {
                    title: 'ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ í•„ë“œë¥¼ í´ë¦­í•˜ì„¸ìš”',
                    desc: 'ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ëŠ” í•„ë“œë¥¼ í´ë¦­í•´ì£¼ì„¸ìš”',
                    step: '2ë‹¨ê³„: ë¹„ë°€ë²ˆí˜¸ í•„ë“œ'
                },
                {
                    title: 'ë¡œê·¸ì¸ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”',
                    desc: 'ë¡œê·¸ì¸ ë²„íŠ¼ ë˜ëŠ” ì œì¶œ ë²„íŠ¼ì„ í´ë¦­í•´ì£¼ì„¸ìš”',
                    step: '3ë‹¨ê³„: ë¡œê·¸ì¸ ë²„íŠ¼'
                }
            ];

            if (currentSelectionStep < steps.length) {
                const current = steps[currentSelectionStep];
                document.getElementById('selectionTitle').textContent = current.title;
                document.getElementById('selectionDesc').textContent = current.desc;
                document.getElementById('selectionStep').textContent = current.step;
            }

            // ì„ íƒëœ ìš”ì†Œë“¤ í‘œì‹œ
            updateSelectedDisplay();
        }

        function updateSelectedDisplay() {
            const display = document.getElementById('selectedDisplay');
            const idDisplay = document.getElementById('selectedIdDisplay');
            const pwDisplay = document.getElementById('selectedPwDisplay');
            const btnDisplay = document.getElementById('selectedBtnDisplay');

            if (manualSelectors.idSelector || manualSelectors.passwordSelector || manualSelectors.buttonSelector) {
                display.style.display = 'block';

                idDisplay.innerHTML = manualSelectors.idSelector
                    ? `âœ… ID í•„ë“œ: <code>${manualSelectors.idSelector}</code>`
                    : '';
                pwDisplay.innerHTML = manualSelectors.passwordSelector
                    ? `âœ… ë¹„ë°€ë²ˆí˜¸ í•„ë“œ: <code>${manualSelectors.passwordSelector}</code>`
                    : '';
                btnDisplay.innerHTML = manualSelectors.buttonSelector
                    ? `âœ… ë¡œê·¸ì¸ ë²„íŠ¼: <code>${manualSelectors.buttonSelector}</code>`
                    : '';
            } else {
                display.style.display = 'none';
            }
        }

        function setupIframeListeners(iframe) {
            try {
                const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;

                if (!iframeDoc || !iframeDoc.body) {
                    console.error('iframe ë¬¸ì„œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                    alert('âš ï¸ ë¯¸ë¦¬ë³´ê¸°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
                    return;
                }

                // ëª¨ë“  í´ë¦­ ê°€ëŠ¥í•œ ìš”ì†Œ ì„ íƒ
                const allElements = iframeDoc.querySelectorAll('input, button, a, [type="submit"]');

                if (allElements.length === 0) {
                    alert('âš ï¸ ì„ íƒ ê°€ëŠ¥í•œ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }

                // ì „ì²´ ë¬¸ì„œì— ì´ë²¤íŠ¸ ìœ„ì„ ë°©ì‹ ì‚¬ìš©
                iframeDoc.body.addEventListener('mouseover', function(e) {
                    const target = e.target;

                    // input, button, a íƒœê·¸ë§Œ ë°˜ì‘
                    if (target.matches('input, button, a, [type="submit"]')) {
                        e.stopPropagation();

                        // ì´ì „ í•˜ì´ë¼ì´íŠ¸ ì œê±°
                        if (lastHighlightedElement && lastHighlightedElement !== target) {
                            lastHighlightedElement.classList.remove('element-highlight');
                        }

                        // ì„ íƒë˜ì§€ ì•Šì€ ìš”ì†Œë§Œ í•˜ì´ë¼ì´íŠ¸
                        if (!target.classList.contains('element-selected')) {
                            target.classList.add('element-highlight');
                        }

                        lastHighlightedElement = target;
                    }
                }, true);

                iframeDoc.body.addEventListener('mouseout', function(e) {
                    const target = e.target;

                    if (target.matches('input, button, a, [type="submit"]')) {
                        // ì„ íƒëœ ìš”ì†Œê°€ ì•„ë‹ˆë©´ í•˜ì´ë¼ì´íŠ¸ ì œê±°
                        if (!target.classList.contains('element-selected')) {
                            target.classList.remove('element-highlight');
                        }
                    }
                }, true);

                // í´ë¦­ ì´ë²¤íŠ¸
                iframeDoc.body.addEventListener('click', function(e) {
                    const target = e.target;

                    if (target.matches('input, button, a, [type="submit"]')) {
                        e.preventDefault();
                        e.stopPropagation();
                        handleElementSelection(target, iframeDoc);
                    }
                }, true);

                console.log(`âœ… ${allElements.length}ê°œì˜ ì„ íƒ ê°€ëŠ¥í•œ ìš”ì†Œë¥¼ ì°¾ì•˜ìŠµë‹ˆë‹¤.`);

            } catch (error) {
                console.error('iframe ì ‘ê·¼ ì˜¤ë¥˜:', error);
                alert('âš ï¸ ë¯¸ë¦¬ë³´ê¸° í˜ì´ì§€ì— ì ‘ê·¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n\në³´ì•ˆ ì •ì±…ìœ¼ë¡œ ì¸í•´ ì¼ë¶€ HTML íŒŒì¼ì€ ë¯¸ë¦¬ë³´ê¸°ê°€ ì œí•œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\nëŒ€ì‹  ìë™ ê°ì§€ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ê±°ë‚˜, ë‹¤ë¥¸ HTML íŒŒì¼ì„ ì‹œë„í•´ì£¼ì„¸ìš”.');
                cancelSelection();
            }
        }

        function handleElementSelection(element, iframeDoc) {
            // ì„ íƒëœ ìš”ì†Œì˜ ì…€ë ‰í„° ìƒì„±
            const selector = generateSelector(element);

            // í˜„ì¬ ë‹¨ê³„ì— ë§ëŠ” ìš”ì†Œì¸ì§€ ê°„ë‹¨í•œ ê²€ì¦
            let isValidSelection = true;
            let warningMessage = '';

            if (currentSelectionStep === 0) {
                // ID í•„ë“œ: text, email íƒ€ì…ë§Œ
                if (element.type === 'password' || element.tagName.toLowerCase() === 'button') {
                    isValidSelection = false;
                    warningMessage = 'âš ï¸ ID ì…ë ¥ í•„ë“œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”. (ì¼ë°˜ í…ìŠ¤íŠ¸ ì…ë ¥ í•„ë“œ)';
                }
            } else if (currentSelectionStep === 1) {
                // ë¹„ë°€ë²ˆí˜¸ í•„ë“œ: password íƒ€ì…ë§Œ
                if (element.type !== 'password') {
                    // ê²½ê³ ë§Œ í•˜ê³  ê³„ì† ì§„í–‰ (ìœ ì—°ì„±)
                    warningMessage = 'ğŸ’¡ ë¹„ë°€ë²ˆí˜¸ í•„ë“œê°€ ë§ë‚˜ìš”? ë³´í†µ type="password"ì¸ í•„ë“œë¥¼ ì„ íƒí•´ì•¼ í•©ë‹ˆë‹¤.';
                }
            } else if (currentSelectionStep === 2) {
                // ë¡œê·¸ì¸ ë²„íŠ¼: button, submit, a íƒœê·¸
                if (element.tagName.toLowerCase() === 'input' && element.type !== 'submit') {
                    warningMessage = 'ğŸ’¡ ë¡œê·¸ì¸ ë²„íŠ¼ì´ ë§ë‚˜ìš”? ë³´í†µ ë²„íŠ¼ ë˜ëŠ” ì œì¶œ ë²„íŠ¼ì„ ì„ íƒí•´ì•¼ í•©ë‹ˆë‹¤.';
                }
            }

            if (!isValidSelection) {
                alert(warningMessage);
                return;
            }

            if (warningMessage) {
                // ê²½ê³ ëŠ” í‘œì‹œí•˜ì§€ë§Œ ì§„í–‰ì€ í—ˆìš©
                console.warn(warningMessage);
            }

            // í˜„ì¬ ìš”ì†Œë¥¼ ì„ íƒëœ ìƒíƒœë¡œ í‘œì‹œ
            element.classList.remove('element-highlight');
            element.classList.add('element-selected');

            // í˜„ì¬ ë‹¨ê³„ì— ë”°ë¼ ì…€ë ‰í„° ì €ì¥
            if (currentSelectionStep === 0) {
                manualSelectors.idSelector = selector;
                console.log('âœ… ID í•„ë“œ ì„ íƒ:', selector);
            } else if (currentSelectionStep === 1) {
                manualSelectors.passwordSelector = selector;
                console.log('âœ… ë¹„ë°€ë²ˆí˜¸ í•„ë“œ ì„ íƒ:', selector);
            } else if (currentSelectionStep === 2) {
                manualSelectors.buttonSelector = selector;
                console.log('âœ… ë¡œê·¸ì¸ ë²„íŠ¼ ì„ íƒ:', selector);
            }

            // ë‹¤ìŒ ë‹¨ê³„ë¡œ ì´ë™
            currentSelectionStep++;

            if (currentSelectionStep >= 3) {
                // ëª¨ë“  ì„ íƒ ì™„ë£Œ
                setTimeout(() => {
                    completeSelection();
                }, 300);
            } else {
                // ë‹¤ìŒ ë‹¨ê³„ ì•ˆë‚´
                updateSelectionGuide();
            }
        }

        function generateSelector(element) {
            // ìš°ì„ ìˆœìœ„: id (ê°€ì¥ êµ¬ì²´ì ) > name > type > class > placeholder > tag

            // 1. ID ì†ì„± (ê°€ì¥ í™•ì‹¤)
            if (element.id && element.id.trim()) {
                return `#${element.id.trim()}`;
            }

            // 2. Name ì†ì„± (í¼ ìš”ì†Œì—ì„œ ì¼ë°˜ì )
            if (element.name && element.name.trim()) {
                const tagName = element.tagName.toLowerCase();
                return `${tagName}[name="${element.name.trim()}"]`;
            }

            // 3. Type ì†ì„±
            if (element.type && element.type.trim()) {
                const tagName = element.tagName.toLowerCase();
                if (tagName === 'button') {
                    return element.type === 'submit' ? `button[type="submit"]` : 'button';
                }
                return `input[type="${element.type.trim()}"]`;
            }

            // 4. Class ì†ì„± (ì²« ë²ˆì§¸ í´ë˜ìŠ¤ë§Œ)
            if (element.className && typeof element.className === 'string' && element.className.trim()) {
                const firstClass = element.className.trim().split(/\s+/)[0];
                return `.${firstClass}`;
            }

            // 5. Placeholder ì†ì„±
            if (element.placeholder && element.placeholder.trim()) {
                return `input[placeholder="${element.placeholder.trim()}"]`;
            }

            // 6. ë§ˆì§€ë§‰ ìˆ˜ë‹¨: íƒœê·¸ëª…
            return element.tagName.toLowerCase();
        }

        function completeSelection() {
            // ìœ íš¨ì„± ê²€ì‚¬
            if (!manualSelectors.idSelector || !manualSelectors.passwordSelector || !manualSelectors.buttonSelector) {
                alert('âš ï¸ ëª¨ë“  ìš”ì†Œë¥¼ ì„ íƒí•´ì•¼ í•©ë‹ˆë‹¤.');
                return;
            }

            // ìˆ˜ë™ ì„ íƒ ì™„ë£Œ
            detectedSelectors = {
                idSelector: manualSelectors.idSelector,
                passwordSelector: manualSelectors.passwordSelector,
                buttonSelector: manualSelectors.buttonSelector,
                isFormSubmit: false
            };

            // ê°ì§€ëœ ì •ë³´ í‘œì‹œ ì—…ë°ì´íŠ¸
            const detectedInfo = document.getElementById('detectedInfo');
            detectedInfo.innerHTML = `
                <div class="detected-info">
                    <h4>âœ… ìˆ˜ë™ìœ¼ë¡œ ì„ íƒëœ ìš”ì†Œ:</h4>
                    <div>ID í•„ë“œ: <code>${manualSelectors.idSelector}</code></div>
                    <div>ë¹„ë°€ë²ˆí˜¸ í•„ë“œ: <code>${manualSelectors.passwordSelector}</code></div>
                    <div>ë¡œê·¸ì¸ ë²„íŠ¼: <code>${manualSelectors.buttonSelector}</code></div>
                    <div style="margin-top: 10px; font-size: 12px; color: #666;">
                        ğŸ’¡ ì„ íƒì´ ì˜ëª»ë˜ì—ˆë‹¤ë©´ "ğŸ¯ ì§ì ‘ ì„ íƒí•˜ê¸°"ë¥¼ ë‹¤ì‹œ í´ë¦­í•˜ì„¸ìš”
                    </div>
                </div>
            `;

            console.log('âœ… ì„ íƒ ì™„ë£Œ:', detectedSelectors);

            // ì„ íƒ ëª¨ë“œ ì¢…ë£Œ
            cancelSelection();

            // ìƒì„± ë²„íŠ¼ í™œì„±í™”
            checkGenerateButton();

            // ì„±ê³µ ë©”ì‹œì§€
            alert('âœ… ìš”ì†Œ ì„ íƒì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!\n\nì´ì œ ì•„ë˜ì—ì„œ ê³„ì • ëª©ë¡ì„ ì…ë ¥í•˜ê³  ë¶ë§ˆí¬ë ›ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
        }

        function cancelSelection() {
            const overlay = document.getElementById('selectionOverlay');
            overlay.classList.remove('active');

            // iframe ë‚´ ëª¨ë“  í•˜ì´ë¼ì´íŠ¸ ì œê±°
            try {
                const iframe = document.getElementById('previewIframe');
                const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;

                if (iframeDoc && iframeDoc.body) {
                    const highlighted = iframeDoc.querySelectorAll('.element-highlight, .element-selected');
                    highlighted.forEach(el => {
                        el.classList.remove('element-highlight', 'element-selected');
                    });
                }
            } catch (error) {
                console.error('í•˜ì´ë¼ì´íŠ¸ ì œê±° ì˜¤ë¥˜:', error);
            }

            // ìƒíƒœ ì´ˆê¸°í™”ëŠ” í•˜ì§€ ì•ŠìŒ (ì¬ì„ íƒ ì‹œ ìœ ì§€)
            lastHighlightedElement = null;
        }
    </script>
</body>
</html>
